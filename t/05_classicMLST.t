#!/usr/bin/env perl

use strict;
use warnings;
use lib './lib';
use File::Basename qw/dirname/;
use FindBin qw/$RealBin/;
use Data::Dumper;

use Test::More tests => 1;

$ENV{PATH} = "$RealBin/../scripts:".$ENV{PATH};
my $thisDir = dirname($0);

subtest 'single mutation' => sub{
  my $aroC_1 = 'GTTTTTCGCCCGGGACACGCGGATTACACCTATGAGCAGAAATACGGCCTGCGCGATTACCGCGGCGGTGGACGTTCTTCCGCGCGTGAAACCGCGATGCGCGTAGCGGCAGGGGCGATCGCCAAGAAATACTTGGCGGAAAAGTTCGGCATCGAAATCCGCGGCTGCCTGACCCAGATGGGCGACATTCCGCTGGAGATTAAAGACTGGCGTCAGGTTGAGCTTAATCCGTTCTTTTGCCCCGATGCGGACAAACTTGACGCGCTGGACGAACTGATGCGCGCGCTGAAAAAAGAGGGTGACTCCATCGGCGCGAAAGTGACGGTGATGGCGAGCGGCGTGCCGGCAGGGCTTGGCGAACCGGTATTTGACCGACTGGATGCGGACATCGCCCATGCGCTGATGAGCATCAATGCGGTGAAAGGCGTGGAGATCGGCGAAGGATTTAACGTGGTGGCGCTGCGCGGCAGCCAGAATCGCGATGAAATCACGGCGCAGGGT';
  my $aroC_X = 'GTTTTTCGCCCGGGACACGCGGATTACACCTATGAGCAGAAATACGGCCTGCGCGATTACCGCGGCGGTGGACGTTCTTCCGCGCGTGAAACCGCGATGCGCGTAGCGGCAGGGGCGATCGCCAAGAAATACTTGGCGGAAAAGTTCGGCATCGAAATCCGCGGCTGCCTGACCCAGATGGGCGACATTCCGCTGGAGATTAAAGACTGGCGTCAGGTTGAGCTTAATCCGTTCTTTTGCGCCGATGCGGACAAACTTGACGCGCTGGACGAACTGATGCGCGCGCTGAAAAAAGAGGGTGACTCCATCGGCGCGAAAGTGACGGTGATGGCGAGCGGCGTGCCGGCAGGGCTTGGCGAACCGGTATTTGACCGACTGGATGCGGACATCGCCCATGCGCTGATGAGCATCAATGCGGTGAAAGGCGTGGAGATCGGCGAAGGATTTAACGTGGTGGCGCTGCGCGGCAGCCAGAATCGCGATGAAATCACGGCGCAGGGT';

  my $exp_1 = 'e8650cab190c617a480c43d607b19726';
  my $exp_X = 'd85fab85b29a8c26f89a4a3b46ec36a6';
  
  my @obs = `hash2seq.pl --max-snps 2 $thisDir/senterica/aroC.tfa $exp_1 $exp_X`;
  chomp(@obs);

  my ($hash1, $seq1) = split(/\t/, $obs[0]);
  is($hash1, $exp_1, "aroC_1 hash");
  is($seq1, $aroC_1, "aroC_1 seq");

  my ($hash2, $seq2) = split(/\t/, $obs[1]);
  is($hash2, $exp_X, "aroC_X hash");
  is($seq2, $aroC_X, "aroC_X seq");
};

